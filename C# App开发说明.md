1.系统定义  
1.1.设计实现的功能    
1.1.1.小车基本行驶功能   
包括前进、后退、原地转向等。    
1.1.2.小车高阶行驶功能    
包括线性动力和线性差速转向等。   
1.1.3.迷宫寻路功能   
在小车基本行驶功能的基础上，配合超声波测距仪，实现小车在迷宫内的自动寻路，达到走出迷宫的目的。    
1.1.4.（跨平台）远程遥控功能    
利用Windows 10或者Windows 10 Mobile的跨平台UWP客户端程序配合小车基本、高阶行驶行驶功能，实现对小车的远程控制，包括：    
控制迷宫模式的启停；    
重力感应控制：利用手机内部加速度计控制线性动力和线性差速转向，实现任意角度可变动力行驶；  
按键控制：触摸/键盘按键控制前进、后退、原地转向；  
模拟摇杆：模拟摇杆控制线性动力和线性差速转向，实现任意角度可变动力行驶；  
1.2.可行性分析  
采用了功能、性能强的大树莓派开发板，虽然只有一个GPIO引脚可以输出PWM调制波，但借助强大的wiringPi树莓派IO控制库，可以实现其他引脚的软PWM输出，从而配合电机驱动芯片，达到控制4个直流电机的目的。  
1.2.1.基本行驶功能  
基本行驶功能可以直接将两侧电机设置成同时前进、同时后退、分别前进后退，来实现。  
1.2.2.高阶行驶功能  
由于没有类似汽车的偏转轮转向系统，故采用差速转向。  
差速转向原理：两侧轮速不同。  
通过调整每个引脚PWM调制波的占空比来控制动力和差速比，以实现高阶行驶功能。  
1.2.3.迷宫寻路功能  
实验平台提供前、左、右三个超声波测距模块，对于各处均为直角墙体的迷宫可以较容易地实现迷宫寻路功能。只需在行驶过程中根据超声波传感器数据调整行驶方向，再配合一定的寻路逻辑，即可实现。    
1.2.4.（跨平台）远程遥控功能    
Linux、Android、iOS、Windows等平台都可以提供Socket，Bluetooth等远程连接方式，这无疑给本设计的实现提供了非常大的便利性以及普适性。   
2.系统总体设计  
2.1.总体设计方案的确定  
2.1.1.硬件平台  
小车端：采用青科智能小车硬件平台，包括树莓派3B开发板、一系列传感器、控制芯片、锂电池以及直流电机。  
控制端：安装有Windows 10操作系统的PC机、Windows Phone、平板电脑、Hololens或者电视机。  
2.1.2.软件平台  
小车端：采用Linux系统以及相应编译工具  
控制端：采用Windows 10或Windows 10 Mobile操作系统，并使用Visual Studio IDE进行开发。  
2.2.软硬件功能划分  
2.2.1.硬件功能  
超声波发射、接收  
直流电机控制  
检测加速度值（手机）  
远程控制输入，包括触摸或按键  
提供网络物理接口（WLAN）  
2.2.2.软件功能  
利用超声波模块测距  
利用PWM调制波控制直流电机  
解析三轴加速度值并量化为、打包控制信号  
将滑动触摸量化、打包为控制信号  
将按键、按钮操作打包为控制信号  
建立Socket连接  
发送、接受以及解析IP数据包  
2.3.硬件体系架构设计  
青科智能小车主要由一块树莓派核心控制板、四个直流减速电机、两节锂电池、三个超声波传感器组成。  

2.4.软件体系架构设计    
2.4.1.小车端  
采用C语言，结合wiringPi控制函数库、pthread线程函数库等实现软件功能，包括：  
初始化  
控制函数定义  
侦听Socket连接  
读取数据包  
解析数据包  
迷宫寻路线程  
测距回传线程  
2.4.2.控制端  
采用C#语言，结合.Net Framework的UWP应用实现，主要包括以下功能：  
初始化  
解析键盘按键（PC）、触摸（手机，包括触摸按键和模拟摇杆）  
解析三轴加速度计数据（手机）  
建立Socket连接  
打包、发送数据包  
读取数据包  
解析、回显数据  
UWP 应用：（Universal Windows Platform, 通用Windows平台）  
能够在运行Windows10的所有设备上使用常见的API。  
可以使用设备的特定功能并让UI适应不同的设备屏幕尺寸、分辨率和DPI。  
可使用C#、C++、Visual Basic和Javascript编程。对于UI，使用XAML、HTML或DirectX。  
3.系统详细设计   
3.1.硬件详细设计    
核心控制板：青科智能车核心控制板采用树莓派三代B型主板，速度更快、性能更强大，是为学生计算机编程教育而设计，只有信用卡大小的卡片式电脑，其系统基于Linux。  
核心控制板参数配置：  
1.2 GHz 四核Broadcom BCM2837 64 位ARMv8 处理器  
板载BCM43143 WiFi  
板载低功耗蓝牙4.1 适配器(BLE)  
1 GB RAM  
4 个USB 2 端口  
微型SD 端口，用于存储操作系统及数据  
CSI 摄像头端口用于连接树莓派摄像头   
4个1:48抗干扰直流减速电机（工作电压3-6V）  
L298N电机驱动芯片(可直接驱动智能车底盘四个电机并可提供PWM使能信号)  
电源：  
LM2596S开关电源稳压电路(支持6~12V宽电压输入，5V输出)  
1个船型电源控制开关(可对整个系统起到很好的电源管理作用)  
2节2500mA容量18650电池  
超声波传感器：  
电压：DC 5V；静态电流：小于2 mA  
感应角度：不大于15 度；探测距离：2 cm-450 cm  
高精度：可达0.3 cm  



![image](https://github.com/QustRobot/AppOnCar/blob/master/images/5.png) 
